{"componentChunkName":"component---src-templates-blog-template-js","path":"/articles/gas-on-terra","result":{"data":{"markdownRemark":{"frontmatter":{"title":"Actual Gas Usage on Terra","date":"2021-09-12T19:41:00.000Z","description":"How much gas can you get away with?","keywords":["luna","crypto","terra","gas"]},"html":"<h2>Introduction</h2>\n<p>Gas on Terra is fairly cheap. It's usually a couple cents or so and is because swaps or transfers are like .0002 of a Luna or something. Interaction with the rest of the Terra ecosystem uses UST for gas, with a usual fixed price of 0.5UST or so. We're interested in how much the gas limit price might be since converting Luna to UST is pretty much a given if you want to interact with the Terra smart contract ecosystem. If we're moving a large amount of money (particularly in adverse market conditions such as a bank run!) we'd like to be able to bridge our money to some sort of stablecoin (ust and anchor protocol!) without paying excessive gas costs. We'll look at the gas used and gas limit for the largest 5 transactions by USD in the past 30 days to get an indicator of what this might look like.</p>\n<h2>Definitions</h2>\n<p>We go by the 5 largest transactions since more money gets moved during adverse conditions. Additionally, we go by value in USD rather than some other relative indicator such as value in Luna. Bread and other stuff is still largely denominated in USD.</p>\n<h2>Methodology</h2>\n<p>We will be taking our data from Flipside Crypto's transfer and swap tables. These represent native swaps / transfers on Terra. We will take all the transactions from the past 30 days for each tables and union them together. We can then order them by the amount in USD they represent and take only the top 5. We will then run a select statement that grabs the gas used and gas limit from the transactions table, looking the transactions up by their transaction ids<sup id=\"fnref-1\"><a href=\"#fn-1\" class=\"footnote-ref\">1</a></sup>.</p>\n<p>This method makes the assumption that the swaps are mostly fair and are not skewed since it relies on token0's price in USD as the price. A more thorough analysis would also look at the price of token1 as well and compare the difference between the two.</p>\n<h2>Data</h2>\n<div class=\"gatsby-resp-iframe-wrapper\" style=\"padding-bottom: 56.25%; position: relative; height: 0; overflow: hidden; \" > <iframe src=\"https://velocity-app.flipsidecrypto.com/velocity/visuals/77d3fe06-df6c-4a47-b8ce-ab86714d48c8/46eb5edc-2559-4934-b768-af063aafc3f3\" style=\" position: absolute; top: 0; left: 0; width: 100%; height: 100%; \"></iframe> </div>\n<p>We can see that all of these transactions consume only 80% of the gas specified in their gas limits. The gas limit is necessarily higher to have a buffer zone to make sure the transactions go through.</p>\n<p>The fact that the gas cost percentage is uniform among all 5 of them during a time when Terra has seen a massive increase in network activity is a fairly good thing. It doesn't really mean much, however, since this is more of a good practice to do on all networks.</p>\n<h2>Conclusions</h2>\n<p><strong>Gas costs on Terra are fairly standard and are low-cost. You can expect your transaction to go through usually if you have a 20% buffer zone.</strong></p>\n<h2>Appendix</h2>\n<div class=\"gatsby-highlight\" data-language=\"sql\"><pre class=\"language-sql\"><code class=\"language-sql\"><span class=\"token keyword\">with</span> txs_transfers <span class=\"token keyword\">as</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">select</span> tx_id<span class=\"token punctuation\">,</span> event_amount_usd <span class=\"token keyword\">from</span> terra<span class=\"token punctuation\">.</span>transfers <span class=\"token keyword\">where</span> event_amount_usd <span class=\"token operator\">IS</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span> <span class=\"token operator\">and</span> block_timestamp::<span class=\"token keyword\">date</span> <span class=\"token operator\">></span> <span class=\"token keyword\">CURRENT_DATE</span> <span class=\"token operator\">-</span> <span class=\"token number\">30</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\ntxs_swaps <span class=\"token keyword\">as</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">select</span> tx_id<span class=\"token punctuation\">,</span> token_0_amount_usd <span class=\"token keyword\">as</span> event_amount_usd <span class=\"token keyword\">from</span> terra<span class=\"token punctuation\">.</span>swaps <span class=\"token keyword\">where</span> block_timestamp::<span class=\"token keyword\">date</span> <span class=\"token operator\">></span> <span class=\"token keyword\">CURRENT_DATE</span> <span class=\"token operator\">-</span> <span class=\"token number\">30</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\ntx_ids <span class=\"token keyword\">as</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">select</span> <span class=\"token operator\">*</span> <span class=\"token keyword\">from</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">select</span> <span class=\"token operator\">*</span> <span class=\"token keyword\">from</span> txs_transfers <span class=\"token keyword\">union</span> <span class=\"token keyword\">all</span> <span class=\"token keyword\">select</span> <span class=\"token operator\">*</span> <span class=\"token keyword\">from</span> txs_swaps<span class=\"token punctuation\">)</span> <span class=\"token keyword\">order</span> <span class=\"token keyword\">by</span> event_amount_usd <span class=\"token keyword\">desc</span> <span class=\"token keyword\">limit</span> <span class=\"token number\">5</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">select</span> tx_id<span class=\"token punctuation\">,</span> gas_used <span class=\"token operator\">/</span> gas_wanted <span class=\"token keyword\">from</span> terra<span class=\"token punctuation\">.</span><span class=\"token keyword\">transactions</span> <span class=\"token keyword\">where</span> tx_id <span class=\"token operator\">in</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">select</span> tx_id <span class=\"token keyword\">from</span> tx_ids<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<div class=\"footnotes\">\n<hr>\n<ol>\n<li id=\"fn-1\">\n<p>Here's the SQL for this method.</p>\n<a href=\"#fnref-1\" class=\"footnote-backref\">â†©</a>\n</li>\n</ol>\n</div>"}},"pageContext":{"slug":"gas-on-terra"}},"staticQueryHashes":["3128451518","3649515864"]}